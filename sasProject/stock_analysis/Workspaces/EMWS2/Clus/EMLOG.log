*------------------------------------------------------------*
User:                dante
Date:                May 26, 2019
Time:                20:12:25
Site:                12600285
Platform:            X64_8HOME
Maintenance Release: 9.04.01M3P062415
EM Version:          14.1
* 
*------------------------------------------------------------*
* Training Log
Date:                May 26, 2019
Time:                20:12:21
*------------------------------------------------------------*
10866  proc freq data=EMWS2.Clus_VariableSet noprint;
10867  table ROLE*LEVEL/out=WORK.ClusMETA;
10868  run;
 
NOTE: There were 8 observations read from the data set EMWS2.CLUS_VARIABLESET.
NOTE: The data set WORK.CLUSMETA has 3 observations and 4 variables.
NOTE: PROCEDURE FREQ used (Total process time):
      real time           0.04 seconds
      cpu time            0.01 seconds
 
 
10869  proc print data=WORK.ClusMETA label noobs;
10870  var ROLE LEVEL COUNT;
10871  label ROLE = "%sysfunc(sasmsg(sashelp.dmine, meta_role_vlabel, NOQUOTE))" LEVEL = "%sysfunc(sasmsg(sashelp.dmine, meta_level_vlabel, NOQUOTE))" COUNT = "%sysfunc(sasmsg(sashelp.dmine, rpt_count_vlabel, NOQUOTE))";
10872  title9 ' ';
10873  title10 "%sysfunc(sasmsg(sashelp.dmine, rpt_varSummary_title  , NOQUOTE))";
10874  run;
 
NOTE: There were 3 observations read from the data set WORK.CLUSMETA.
NOTE: The PROCEDURE PRINT printed page 1.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
 
 
10875  title10;
 
10876  data WORK.M06R7Y4B;
10877  set WORK.M06R7Y4B;
10878  if role eq 'REJECTED' then role = 'INPUT';
10879  run;
 
NOTE: There were 5 observations read from the data set WORK.M06R7Y4B.
NOTE: The data set WORK.M06R7Y4B has 5 observations and 21 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
10888  *------------------------------------------------------------*;
10889  * Clus: Preliminary Clustering;
10890  *------------------------------------------------------------*;
10891  *------------------------------------------------------------* ;
10892  * Clus: DMDBClass Macro ;
10893  *------------------------------------------------------------* ;
10894  %macro DMDBClass;
10895
10896  %mend DMDBClass;
10897  *------------------------------------------------------------* ;
10898  * Clus: DMDBVar Macro ;
10899  *------------------------------------------------------------* ;
10900  %macro DMDBVar;
10901      close high low open vol
10902  %mend DMDBVar;
10903  *------------------------------------------------------------*;
10904  * Clus: Create DMDB;
10905  *------------------------------------------------------------*;
10906  proc dmdb batch data=EMWS2.Filter_TRAIN
10907  dmdbcat=WORK.Clus_DMDB
10908  maxlevel = 513
10909  out=WORK.Clus_DMDB
10910  ;
10911  var %DMDBVar;
10912  run;
 
NOTE: Records processed = 27816   Memory used = 511K.
NOTE: There were 28401 observations read from the data set AAEM61.DTSTOCK_TRAIN.
NOTE: View EMWS2.FILTER_TRAIN.VIEW used (Total process time):
      real time           0.06 seconds
      cpu time            0.04 seconds
 
NOTE: There were 28401 observations read from the data set EMWS2.IDS3_DATA.
NOTE: There were 27816 observations read from the data set EMWS2.FILTER_TRAIN.
NOTE: The data set WORK.CLUS_DMDB has 27816 observations and 5 variables.
NOTE: PROCEDURE DMDB used (Total process time):
      real time           0.09 seconds
      cpu time            0.06 seconds
 
 
10913  quit;
10914  *--- end code ---*;
 
10915  *------------------------------------------------------------* ;
10916  * Clus: Interval Inputs Macro ;
10917  *------------------------------------------------------------* ;
10918  %macro DMVQINTERVAL;
10919      close high low open vol
10920  %mend DMVQINTERVAL;
10921  *------------------------------------------------------------*;
10922  * Clus: Run DMVQ procedure;
10923  *------------------------------------------------------------*;
10924  title;
10925  options nodate;
10926  proc dmvq data=WORK.Clus_DMDB dmdbcat=WORK.Clus_DMDB std=STD nominal=GLM ordinal=RANK
10927  ;
NOTE: The training set WORK.CLUS_DMDB.DATA has 5 variable(s).
NOTE: The DMVQ statement has finished with return code=0 and status=begin.
10928  input %DMVQINTERVAL / level=interval;
NOTE: 5 input variable(s) defined for ID=I1.
NOTE: The INPUT statement has finished with return code=0 and status=variables.
10929  VQ maxc = 50 clusname=_SEGMENT_ CLUSLABEL="Segment Id" DISTLABEL="Distance";
NOTE: A maximum of 50 clusters have been requested.
NOTE: The VQ statement has finished with return code=0 and status=architecture.
10930  MAKE outvar=EMWS2.Clus_OUTVAR;
 
NOTE: 5 input variable(s).
NOTE: Number of cases=27816
NOTE: Sum of frequencies=27816
NOTE: Sum of weights=27816
NOTE: VARDEF=DF
NOTE: Maximum number of categories=0
NOTE: The total number of variables is 5 with dimensionality 5.
NOTE: 5 variables will be used for clustering.
NOTE: Open output data set EMWS2.CLUS_OUTVAR.DATA with 6 variables.
NOTE: The data set EMWS2.CLUS_OUTVAR has 4 observations and 6 variables.
NOTE: The MAKE statement has finished with return code=0 and status=made.
10931  INITIAL radius=0
10932  ;
NOTE: 50 seeds were selected from data set WORK.CLUS_DMDB.DATA using the SEPARATE algorithm.
NOTE: The INITIAL statement has finished with return code=0 and status=initialized.
10933  TRAIN tech=FORGY
10934  ;
WARNING: The limit of 10 iterations was reached without convergence.
NOTE: The TRAIN statement has finished with return code=0 and status=trained.
10935  SAVE outstat=WORK.Clus_OUTSTAT outmean=EMWS2.Clus_OUTMEAN;
NOTE: The data set WORK.CLUS_OUTSTAT has 316 observations and 8 variables.
NOTE: The data set EMWS2.CLUS_OUTMEAN has 50 observations and 14 variables.
NOTE: The SAVE statement has finished with return code=0 and status=statistics.
10936  code file="C:\Users\dante\Documents\My SAS Files\9.4\stock3\Workspaces\EMWS2\Clus\DMVQSCORECODE.sas"
10937  group=Clus
10938  ;
NOTE: External file C:\Users\dante\Documents\My SAS Files\9.4\stock3\Workspaces\EMWS2\Clus\DMVQSCORECODE.sas opened.
NOTE: The CODE statement has finished with return code=0 and status=statistics.
10939  run;
 
10940  quit;
 
NOTE: There were 27816 observations read from the data set WORK.CLUS_DMDB.
NOTE: PROCEDURE DMVQ used (Total process time):
      real time           0.09 seconds
      cpu time            0.07 seconds
 
 
10941  proc transpose data=EMWS2.Clus_OUTVAR out=WORK.Clus_OUTVAR(where=(COL1 ^in('IMPUTED','OMITTED')));
10942  var close--vol;
10943  where _TYPE_ in('TYPE' 'VARIABLE');
10944  run;
 
NOTE: There were 2 observations read from the data set EMWS2.CLUS_OUTVAR.
      WHERE _TYPE_ in ('TYPE', 'VARIABLE');
NOTE: The data set WORK.CLUS_OUTVAR has 5 observations and 3 variables.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
 
 
10945  *------------------------------------------------------------* ;
10946  * Clus: DMVQ Variables;
10947  *------------------------------------------------------------* ;
10948  %macro dmvqvars;
10949      close high low open vol
10950  %mend ;
10951
10952
 
10953  *------------------------------------------------------------*;
10954  * Clus: Determining the number of clusters;
10955  *------------------------------------------------------------*;
10956  proc cluster data=EMWS2.Clus_OUTMEAN method=WARD pseudo outtree=EMWS2.Clus_CLUSSEED
10957  ;
10958  var %dmvqvars;
10959  copy _SEGMENT_;
10960  run;
 
WARNING: Ties for minimum distance between clusters have been detected at 2 level(s) in the cluster history.
NOTE: The data set EMWS2.CLUS_CLUSSEED has 99 observations and 22 variables.
NOTE: The PROCEDURE CLUSTER printed page 2.
NOTE: PROCEDURE CLUSTER used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
10961  quit;
10962  proc sort data =EMWS2.Clus_CLUSSEED out=WORK._SEED_;
10963  by _ncl_;
10964  where (_ccc_ > -99999.0);
10965  run;
 
NOTE: There were 49 observations read from the data set EMWS2.CLUS_CLUSSEED.
      WHERE _ccc_>-99999;
NOTE: The data set WORK._SEED_ has 49 observations and 22 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
 
 
10966  data WORK._SEED2_;
10967  retain oJump occc oncl;
10968  set WORK._SEED_;
10969  _lccc_=lag(_ccc_);
10970  if _lccc_ > . then jump = _ccc_ - _lccc_;
10971  if jump<0 and ojump>0 then do;
10972  * Have a local Max;
10973  numclus = oncl;
10974  cccvalue = occc;
10975  output;
10976  end;
10977  ojump = jump;
10978  occc = _ccc_;
10979  oncl = _ncl_;
10980  run;
 
NOTE: There were 49 observations read from the data set WORK._SEED_.
NOTE: The data set WORK._SEED2_ has 1 observations and 29 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
 
 
10981  proc print data=WORK._SEED2_ label;
10982  var numclus cccvalue;
10983  label numclus="%sysfunc(sasmsg(sashelp.dmine, rpt_numclus_vlabel ,  NOQUOTE))";
10984  label cccvalue="%sysfunc(sasmsg(sashelp.dmine, rpt_ccc_vlabel ,     NOQUOTE))";
10985  title10 "%sysfunc(sasmsg(sashelp.dmine, rpt_OptClus_title, NOQUOTE))";
10986  run;
 
NOTE: There were 1 observations read from the data set WORK._SEED2_.
NOTE: The PROCEDURE PRINT printed page 3.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
10987  title10;
 
10988  data WORK._SEED2_;
10989  length msg $200;
10990  set WORK._SEED2_ end=eof;
10991  retain select cccSelect 0 numSel;
10992  if _N_=1 then numSel = numClus;
10993  if cccvalue>=3 then do;
10994  if 20>= numclus >= 2 and cccSelect<1 then do;
10995  cccSelect = 1;
10996  select =1;
10997  numSel = numClus;
10998  end;
10999  end;
11000  else if 20>= numclus >= 2 and select<1 then do;
11001  select = 1;
11002  numSel = numClus;
11003  end;
11004  if eof then do;
11005  if ^(select=1 and cccselect=1) then do;
11006  put "*------------------------------------------------------------*";
11007  put '*;';
11008  put "WARNING: The number of clusters selected based on the CCC values may not be valid.  Please refer to the documentation on the Cubic Clustering Criterion.";
11009  put '*;';
11010  put "*------------------------------------------------------------*";
11011  end;
11012  if select<1 then do;
11013  msg = sasmsg('sashelp.dmine', 'rpt_noCCCclusternum_note', 'NOQUOTE');
11014  put msg;
11015  end;
11016  if cccselect<1 then do;
11017  msg = sasmsg('sashelp.dmine', 'rpt_noValidclusterNum_note', 'NOQUOTE');
11018  put msg;
11019  end;
11020  call symput('em_maxC', strip(put(numSel,best.)));
11021  end;
11022  run;
 
*------------------------------------------------------------*
*;
WARNING: The number of clusters selected based on the CCC values may not be valid.  Please refer to the documentation on the Cubic Clustering Criterion.
*;
*------------------------------------------------------------*
There are no number of cluster matching the specified minimum and maximum number of clusters.  The number of clusters will be set to the first local peak.
NOTE: There were 1 observations read from the data set WORK._SEED2_.
NOTE: The data set WORK._SEED2_ has 1 observations and 33 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
11023  *------------------------------------------------------------*;
11024  * Clus: Training;
11025  *------------------------------------------------------------*;
11026  *------------------------------------------------------------*;
11027  * Clus: Run DMVQ procedure;
11028  *------------------------------------------------------------*;
11029  title;
11030  options nodate;
11031  proc dmvq data=WORK.Clus_DMDB dmdbcat=WORK.Clus_DMDB std=STD nominal=GLM ordinal=RANK
11032  ;
NOTE: The training set WORK.CLUS_DMDB.DATA has 5 variable(s).
NOTE: The DMVQ statement has finished with return code=0 and status=begin.
11033  input %DMVQINTERVAL / level=interval;
NOTE: 5 input variable(s) defined for ID=I1.
NOTE: The INPUT statement has finished with return code=0 and status=variables.
11034  VQ maxc = 3 clusname=_SEGMENT_ CLUSLABEL="Segment Id" DISTLABEL="Distance";
NOTE: A maximum of 3 clusters have been requested.
NOTE: The VQ statement has finished with return code=0 and status=architecture.
11035  MAKE outvar=EMWS2.Clus_OUTVAR;
 
NOTE: 5 input variable(s).
NOTE: Number of cases=27816
NOTE: Sum of frequencies=27816
NOTE: Sum of weights=27816
NOTE: VARDEF=DF
NOTE: Maximum number of categories=0
NOTE: The total number of variables is 5 with dimensionality 5.
NOTE: 5 variables will be used for clustering.
NOTE: Open output data set EMWS2.CLUS_OUTVAR.DATA with 6 variables.
NOTE: The data set EMWS2.CLUS_OUTVAR has 4 observations and 6 variables.
NOTE: The MAKE statement has finished with return code=0 and status=made.
11036  INITIAL radius=0
11037  ;
NOTE: 3 seeds were selected from data set WORK.CLUS_DMDB.DATA using the SEPARATE algorithm.
NOTE: The INITIAL statement has finished with return code=0 and status=initialized.
11038  TRAIN tech=FORGY
11039  ;
NOTE: F-Convergence criterion is satisfied.
NOTE: The TRAIN statement has finished with return code=0 and status=trained.
11040  SAVE outstat=EMWS2.Clus_OUTSTAT outmean=EMWS2.Clus_OUTMEAN;
NOTE: The data set EMWS2.CLUS_OUTSTAT has 34 observations and 8 variables.
NOTE: The data set EMWS2.CLUS_OUTMEAN has 3 observations and 14 variables.
NOTE: The SAVE statement has finished with return code=0 and status=statistics.
11041  code file="C:\Users\dante\Documents\My SAS Files\9.4\stock3\Workspaces\EMWS2\Clus\DMVQSCORECODE.sas"
11042  group=Clus
11043  ;
NOTE: External file C:\Users\dante\Documents\My SAS Files\9.4\stock3\Workspaces\EMWS2\Clus\DMVQSCORECODE.sas opened.
NOTE: The CODE statement has finished with return code=0 and status=statistics.
11044  run;
 
11045  quit;
 
NOTE: There were 27816 observations read from the data set WORK.CLUS_DMDB.
NOTE: PROCEDURE DMVQ used (Total process time):
      real time           0.04 seconds
      cpu time            0.03 seconds
 
 
11046  libname _spdslib;
WARNING: Libref _SPDSLIB is not assigned.
 
11047  *------------------------------------------------------------*;
11048  * Clus: Cluster Label;
11049  *------------------------------------------------------------*;
11050  data EMWS2.Clus_LABEL;
11051  length _SEGMENT_ 8 Label $80;
11052  format _SEGMENT_ 4.;
11053  label _SEGMENT_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_segmentName_vlabel,  NOQUOTE))";
11054  label Label = "%sysfunc(sasmsg(sashelp.dmine, rpt_segmentLabel_vlabel,  NOQUOTE))";
11055  _SEGMENT_= 1;
11056  Label='Cluster1';
11057  output;
11058  _SEGMENT_= 2;
11059  Label='Cluster2';
11060  output;
11061  _SEGMENT_= 3;
11062  Label='Cluster3';
11063  output;
11064  run;
 
NOTE: The data set EMWS2.CLUS_LABEL has 3 observations and 2 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
 
 
*------------------------------------------------------------*
* Score Log
Date:                May 26, 2019
Time:                20:12:22
*------------------------------------------------------------*
11166  proc transpose data=EMWS2.Clus_OUTVAR out=WORK.Clus_OUTVAR(rename=(COl2=NAME) where=(COL1='IMPUTED'));
11167  var close--vol;
11168  where _TYPE_ in('TYPE' 'VARIABLE');
11169  run;
 
NOTE: There were 2 observations read from the data set EMWS2.CLUS_OUTVAR.
      WHERE _TYPE_ in ('TYPE', 'VARIABLE');
NOTE: The data set WORK.CLUS_OUTVAR has 0 observations and 3 variables.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
 
 
11170  proc sort data=WORK.Clus_OUTVAR;
11171  by NAME;
11172  run;
 
NOTE: Input data set is empty.
NOTE: The data set WORK.CLUS_OUTVAR has 0 observations and 3 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
 
 
11173  proc sort data=EMWS2.Clus_VariableSet(KEEP=NAME ROLE LEVEL) out=WORK.Clus_SORTEDVARS;
11174  by NAME;
11175  run;
 
NOTE: There were 8 observations read from the data set EMWS2.CLUS_VARIABLESET.
NOTE: The data set WORK.CLUS_SORTEDVARS has 8 observations and 3 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
 
 
11176  data WORK.Clus_OUTVAR;
11177  merge WORK.Clus_OUTVAR(in=INVAR) WORK.Clus_SORTEDVARS;
11178  by NAME;
11179  if INVAR then output;
11180  run;
 
WARNING: Multiple lengths were specified for the BY variable NAME by input data sets. This might cause unexpected results.
NOTE: There were 0 observations read from the data set WORK.CLUS_OUTVAR.
NOTE: There were 8 observations read from the data set WORK.CLUS_SORTEDVARS.
NOTE: The data set WORK.CLUS_OUTVAR has 0 observations and 5 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
 
 
NOTE: This SAS session is using a registry in WORK.  All changes will be lost at the end of this session.
11181  filename emflow "C:\Users\dante\Documents\My SAS Files\9.4\stock3\Workspaces\EMWS2\Clus\EMFLOWSCORE.sas";
11182  *------------------------------------------------------------*;
11183  * Clus: Scoring DATA data;
11184  *------------------------------------------------------------*;
11185  data EMWS2.Clus_TRAIN
11186  / view=EMWS2.Clus_TRAIN
11187  ;
11188  set EMWS2.Filter_TRAIN
11189  ;
11190  %inc emflow;
11300  run;
 
NOTE: DATA STEP view saved on file EMWS2.CLUS_TRAIN.
NOTE: A stored DATA STEP view cannot run under a different operating system.
NOTE: View EMWS2.FILTER_TRAIN.VIEW used (Total process time):
      real time           0.04 seconds
      cpu time            0.04 seconds
 
NOTE: DATA statement used (Total process time):
      real time           0.05 seconds
      cpu time            0.07 seconds
 
 
11301  quit;
11302  filename emflow;
NOTE: Fileref EMFLOW has been deassigned.
 
11303  *------------------------------------------------------------*;
11304  * Clus: Computing metadata for TRAIN data;
11305  *------------------------------------------------------------*;
 
NOTE: View EMWS2.CLUS_TRAIN.VIEW used (Total process time):
      real time           0.05 seconds
      cpu time            0.06 seconds
 
NOTE: View EMWS2.CLUS_TRAIN.VIEW used (Total process time):
      real time           0.05 seconds
      cpu time            0.04 seconds
 
*------------------------------------------------------------*
* Report Log
Date:                May 26, 2019
Time:                20:12:23
*------------------------------------------------------------*
11715  data WORK.M3LOQZA5;
11716  set WORK.M3LOQZA5;
11717  if role eq 'REJECTED' then role = 'INPUT';
11718  run;
 
NOTE: There were 5 observations read from the data set WORK.M3LOQZA5.
NOTE: The data set WORK.M3LOQZA5 has 5 observations and 21 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
11719  data WORK.M3LOQZA5;
11720  set WORK.M3LOQZA5 end=_eof_ nobs=_nobs_;
11721  output;
11722  if _eof_ then do;
11723  name = '_SEGMENT_';
11724  ROLE = 'TARGET';
11725  LEVEL = 'NOMINAL';
11726  LABEL = 'Segment Variable';
11727  TYPE = 'N';
11728  FORMAT = '';
11729  INFORMAT = '';
11730  USE='Y';
11731  output;
11732  end;
11733  run;
 
NOTE: There were 5 observations read from the data set WORK.M3LOQZA5.
NOTE: The data set WORK.M3LOQZA5 has 6 observations and 21 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
11734  *------------------------------------------------------------*;
11735  * Clus: Create decision matrix;
11736  *------------------------------------------------------------*;
11737  *------------------------------------------------------------* ;
11738  * Clus: Tree Variables Macro ;
11739  *------------------------------------------------------------* ;
11740  %macro EM_TREEVARS;
11741      close high low open vol
11742  %mend EM_TREEVARS;
11743  *------------------------------------------------------------* ;
11744  * Clus: Tree Targets Macro ;
11745  *------------------------------------------------------------* ;
11746  %macro EM_TREETARGETS;
11747      _SEGMENT_
11748  %mend EM_TREETARGETS;
11749  data EMWS2.EM_Clus / view=EMWS2.EM_Clus;
11750  set EMWS2.Clus_TRAIN(keep=%EM_TREEVARS %EM_TREETARGETS);
11751  run;
 
NOTE: DATA STEP view saved on file EMWS2.EM_CLUS.
NOTE: A stored DATA STEP view cannot run under a different operating system.
NOTE: View EMWS2.CLUS_TRAIN.VIEW used (Total process time):
      real time           0.06 seconds
      cpu time            0.07 seconds
 
NOTE: DATA statement used (Total process time):
      real time           0.07 seconds
      cpu time            0.07 seconds
 
 
11752  *------------------------------------------------------------* ;
11753  * Clus: Interval Inputs Macro ;
11754  *------------------------------------------------------------* ;
11755  %macro INTINPUTS;
11756      close high low open vol
11757  %mend INTINPUTS;
11758  *------------------------------------------------------------* ;
11759  * Clus: Binary and Nominal Inputs Macro ;
11760  *------------------------------------------------------------* ;
11761  %macro NOMINPUTS;
11762
11763  %mend NOMINPUTS;
11764  *------------------------------------------------------------* ;
11765  * Clus: Ordinal Inputs Macro ;
11766  *------------------------------------------------------------* ;
11767  %macro ORDINPUTS;
11768
11769  %mend ORDINPUTS;
11770  *------------------------------------------------------------*;
11771  * Clus: Run ARBOR procedure;
11772  *------------------------------------------------------------*;
 
11773  proc arbor data=EMWS2.EM_Clus
11774  MAXSURRS=4
11775  ;
11776  ;
11777  input %INTINPUTS
11778  / level = interval;
11779  target _SEGMENT_ / level=NOMINAL
11780  Criterion=PROBCHISQ
11781  ;
11782  ;
11783  Performance DISK
11784  ;
11785  MAKEMACRO NLEAVES=nleaves;
NOTE: 1437154 kilobytes of physical memory.
NOTE: Will use 27816 out of 27816 training cases.
NOTE: Using memory pool with 110110720 bytes.
NOTE: Passed training data 10 times.
NOTE: Training used 1754552 bytes of work memory.
NOTE: The subtree sequence contains 6 subtrees. The largest has 11 nodes and 6 leaves.
NOTE: Using subtree with 9 nodes and 5 leaves.
NOTE: Created macro variable NLEAVES equal to 5.
11786  save
11787  MODEL=EMWS2.Clus_PLOTDS
11788  SEQUENCE=EMWS2.Clus_OUTSEQ
11789  IMPORTANCE=EMWS2.Clus_OUTIMPORT
11790  NODESTAT=EMWS2.Clus_OUTNODES
11791  SUMMARY=WORK.OUTSUMMARY_TREE_2RTAMS3
11792  STATSBYNODE=WORK.OUTSTATS_TREE_2RTAMS3
11793  Pathlistnonmissing = WORK.OUTPATH_TREE_2RTAMS3
11794  Rules = WORK.OUTRULES_TREE_2RTAMS3
11795  ;
NOTE: The data set EMWS2.CLUS_OUTIMPORT has 5 observations and 5 variables.
NOTE: The data set EMWS2.CLUS_PLOTDS has 458 observations and 4 variables.
NOTE: The data set EMWS2.CLUS_OUTNODES has 9 observations and 22 variables.
NOTE: The data set WORK.OUTPATH_TREE_2RTAMS3 has 25 observations and 7 variables.
NOTE: The data set WORK.OUTRULES_TREE_2RTAMS3 has 104 observations and 6 variables.
NOTE: The data set EMWS2.CLUS_OUTSEQ has 6 observations and 11 variables.
NOTE: The data set WORK.OUTSTATS_TREE_2RTAMS3 has 45 observations and 5 variables.
NOTE: The data set WORK.OUTSUMMARY_TREE_2RTAMS3 has 16 observations and 6 variables.
11796  run;
 
11797  quit;
 
NOTE: There were 28401 observations read from the data set AAEM61.DTSTOCK_TRAIN.
NOTE: There were 28401 observations read from the data set EMWS2.IDS3_DATA.
NOTE: There were 27816 observations read from the data set EMWS2.FILTER_TRAIN.
NOTE: View EMWS2.EM_CLUS.VIEW used (Total process time):
      real time           0.35 seconds
      cpu time            0.31 seconds
 
NOTE: There were 27816 observations read from the data set EMWS2.CLUS_TRAIN.
NOTE: There were 27816 observations read from the data set EMWS2.EM_CLUS.
NOTE: The data set WORK._NAMEDAT has 3 observations and 5 variables.
NOTE: PROCEDURE ARBOR used (Total process time):
      real time           0.37 seconds
      cpu time            0.32 seconds
 
 
11798  data EMWS2.Clus_OUTIMPORT;
11799  set EMWS2.Clus_OUTIMPORT;
11800  label NAME = "%sysfunc(sasmsg(sashelp.dmine, meta_name_vlabel, noquote))" LABEL = "%sysfunc(sasmsg(sashelp.dmine, meta_label_vlabel, noquote))" NRULES = "%sysfunc(sasmsg(sashelp.dmine, rpt_nrules_vlabel, noquote))" IMPORTANCE =
11801     "%sysfunc(sasmsg(sashelp.dmine, rpt_importance_vlabel, noquote))" NSURROGATES = "%sysfunc(sasmsg(sashelp.dmine, rpt_nsurrogates_vlabel, noquote))"
11802  ;
11803  run;
 
NOTE: There were 5 observations read from the data set EMWS2.CLUS_OUTIMPORT.
NOTE: The data set EMWS2.CLUS_OUTIMPORT has 5 observations and 5 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
 
 
11804  filename x "C:\Users\dante\Documents\My SAS Files\9.4\stock3\Workspaces\EMWS2\Clus\ENGLISHRULES.txt" encoding='utf-8' NOBOM;
 
11805  data temp;
11806  length varname $5;
11807  retain varname;
11808  set WORK.OUTPATH_TREE_2RTAMS3;
11809  if ^missing(variable) then varname=variable;
11810  else if ^missing(var_name) then varname=var_name;
11811  output;
11812  run;
 
NOTE: There were 25 observations read from the data set WORK.OUTPATH_TREE_2RTAMS3.
NOTE: The data set WORK.TEMP has 25 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
11813  proc sort data=temp;
11814  by node;
11815  run;
 
NOTE: There were 25 observations read from the data set WORK.TEMP.
NOTE: The data set WORK.TEMP has 25 observations and 8 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
11816  proc sort data=EMWS2.Clus_OUTNODES out=outnodes;
11817  by node;
11818  run;
 
NOTE: There were 9 observations read from the data set EMWS2.CLUS_OUTNODES.
NOTE: The data set WORK.OUTNODES has 9 observations and 22 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
11819  data temp;
11820  merge temp(in=_a) outnodes(keep= node
11821  NPRIORS
11822  P__SEGMENT_1
11823  P__SEGMENT_3
11824  P__SEGMENT_2
11825  );
11826  by node;
11827  if _a;
11828  run;
 
NOTE: There were 25 observations read from the data set WORK.TEMP.
NOTE: There were 9 observations read from the data set WORK.OUTNODES.
NOTE: The data set WORK.TEMP has 25 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
11829  proc sort data=temp;
11830  by node descending varname descending numeric_value;
11831  run;
 
NOTE: There were 25 observations read from the data set WORK.TEMP.
NOTE: The data set WORK.TEMP has 25 observations and 12 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
 
 
11832  data _null_;
11833  file x;
11834  set temp;
11835  by node descending varname;
11836  retain origvar oldnode string;
11837  length origvar $32 oldnode 8 string $200;
11838  if _n_ = 1 then do;
11839  origvar = varname;
11840  oldnode = node;
11841  end;
11842  if first.node then do;
11843  put "&EM_CODEBAR";
11844  put " Node = " node;
11845  put "&EM_CODEBAR";
11846  end;
11847  if first.varname then do;
11848  if RELATION ^in ("=", "ISMISSING", "ISNOTMISSING") then do;
11849  if MISSING(CHARACTER_VALUE) then do;
11850  if NUMERIC_VALUE ne . then do;
11851  if ^first.node then do;
11852  string= "AND "|| strip(varname)||" "||strip(relation)||" "||strip(numeric_value);
11853  end;
11854  else do;
11855  string= "if "|| strip(varname)||" "||strip(relation)||" "||strip(numeric_value);
11856  end;
11857  end;
11858  end;
11859  else do;
11860  if ^first.node then do;
11861  string= "AND "|| strip(varname)||" "||strip(relation)||" "||strip(character_value);
11862  end;
11863  else do;
11864  string= "if "|| strip(varname)||" "||strip(relation)||" "||strip(character_value);
11865  end;
11866  end;
11867  end;
11868  else if RELATION in ("=") then do;
11869  if ^first.node then do;
11870  string = "AND "||strip(varname) ||" IS ONE OF: "||character_value;
11871  end;
11872  else do;
11873  string = "if "|| strip(varname) ||" IS ONE OF: "||character_value;
11874  end;
11875  end;
11876  else if RELATION in ("ISMISSING") then do;
11877  if ^first.node then do;
11878  string = " AND "|| strip(varname) || " equals Missing";
11879  end;
11880  else do;
11881  string = "if "|| strip(varname) ||" equals Missing";
11882  end;
11883  end;
11884  else if RELATION in ("ISNOTMISSING") then do;
11885  if ^first.node then do;
11886  string = " AND "|| strip(varname) || " equals All Values";
11887  end;
11888  else do;
11889  string = "if "|| strip(varname) ||" equals All Values";
11890  end;
11891  end;
11892  if ^missing(varname) then origvar = varname;
11893  oldnode=node;
11894  end;
11895  else do;
11896  if RELATION ^in ("=", "ISMISSING", "ISNOTMISSING") then do;
11897  if MISSING(CHARACTER_VALUE) then do;
11898  if NUMERIC_VALUE ne . then do;
11899  if ^MISSING(string) then string= strip(string)||" AND "|| strip(varname)||" "||strip(relation)||" "||strip(numeric_value);
11900  else string= " if "|| strip(varname)||" "||strip(relation)||" "||strip(numeric_value);
11901  end;
11902  end;
11903  else do;
11904  if ^MISSING(string) then string= strip(string)||" AND "|| strip(varname)||" "||strip(relation)||" "||strip(character_value);
11905  else string= " if "|| strip(varname)||" "||strip(relation)||" "||strip(character_value);
11906  end;
11907  end;
11908  else if RELATION in ("=") then do;
11909  string = strip(string)||", "||strip(character_value);
11910  end;
11911  else if RELATION in ("ISMISSING") then do;
11912  end;
11913  if ^missing(varname) then origvar = varname;
11914  oldnode=node;
11915  end;
11916  if last.varname then do;
11917  if RELATION in ("ISMISSING") then do;
11918  if ^first.varname then do;
11919  string = strip(string) || " or MISSING";
11920  end;
11921  end;
11922  put string;
11923  if ^missing(varname) then origvar = varname;
11924  oldnode=node;
11925  end;
11926  if last.node then do;
11927  put "then ";
11928  put " Tree Node Identifier   = " node;
11929  put " Number of Observations = " NPRIORS;
11930  put " Predicted: _SEGMENT_=1  = " P__SEGMENT_1;
11931  put " Predicted: _SEGMENT_=3  = " P__SEGMENT_3;
11932  put " Predicted: _SEGMENT_=2  = " P__SEGMENT_2;
11933  put " ";
11934  if ^missing(varname) then origvar = varname;
11935  oldnode=node;
11936  end;
11937  run;
 
NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      11852:67    11855:66    11899:108   11900:72
NOTE: The file X is:
      Filename=C:\Users\dante\Documents\My SAS Files\9.4\stock3\Workspaces\EMWS2\Clus\ENGLISHRULES.txt,
      RECFM=V,LRECL=131068,File Size (bytes)=0,
      Last Modified=26May2019:20:12:23,
      Create Time=26May2019:20:12:23
 
NOTE: 60 records were written to the file X.
      The minimum record length was 1.
      The maximum record length was 62.
NOTE: There were 25 observations read from the data set WORK.TEMP.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
11938  filename x;
NOTE: Fileref X has been deassigned.
 
11939  /* belowtext */
11940  data templabel;
11941  set WORK.OUTRULES_TREE_2RTAMS3;
11942  if ((ROLE="PRIMARY") AND (STAT ="LABEL"));
11943  rename character_value = belowtext;
11944  keep NODE character_value;
11945  run;
 
NOTE: There were 104 observations read from the data set WORK.OUTRULES_TREE_2RTAMS3.
NOTE: The data set WORK.TEMPLABEL has 0 observations and 2 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
 
 
11946  data tempvar;
11947  set WORK.OUTRULES_TREE_2RTAMS3;
11948  if ((ROLE="PRIMARY") AND (STAT="VARIABLE"));
11949  keep NODE character_value;
11950  run;
 
NOTE: There were 104 observations read from the data set WORK.OUTRULES_TREE_2RTAMS3.
NOTE: The data set WORK.TEMPVAR has 4 observations and 2 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
11951  proc sort data=templabel;
11952  by node;
11953  run;
 
NOTE: Input data set is empty.
NOTE: The data set WORK.TEMPLABEL has 0 observations and 2 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
11954  proc sort data=tempvar;
11955  by node;
11956  run;
 
NOTE: There were 4 observations read from the data set WORK.TEMPVAR.
NOTE: The data set WORK.TEMPVAR has 4 observations and 2 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
11957  data tempbelow;
11958  merge templabel tempvar;
11959  by node;
11960  if missing(belowtext) then belowtext= character_value;
11961  keep node belowtext;
11962  run;
 
NOTE: There were 0 observations read from the data set WORK.TEMPLABEL.
NOTE: There were 4 observations read from the data set WORK.TEMPVAR.
NOTE: The data set WORK.TEMPBELOW has 4 observations and 2 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
11963  proc sort data=tempbelow;
11964  by node;
11965  run;
 
NOTE: There were 4 observations read from the data set WORK.TEMPBELOW.
NOTE: The data set WORK.TEMPBELOW has 4 observations and 2 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
11966  /* abovetext */
11967  data tempoutrules;
11968  set WORK.OUTRULES_TREE_2RTAMS3;
11969  if ((ROLE='PRIMARY') AND(STAT in ("INTERVAL", "ORDINAL", "NOMINAL")));
11970  run;
 
NOTE: There were 104 observations read from the data set WORK.OUTRULES_TREE_2RTAMS3.
NOTE: The data set WORK.TEMPOUTRULES has 4 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
11971  proc sort data=tempoutrules;
11972  by node numeric_value;
11973  run;
 
NOTE: There were 4 observations read from the data set WORK.TEMPOUTRULES.
NOTE: The data set WORK.TEMPOUTRULES has 4 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
 
 
11974  data tempabove;
11975  set tempoutrules(rename=(node=parent));
11976  by parent numeric_value;
11977  retain abovetext tempstring flag branch origval origchar;
11978  *length abovetext tempstring origchar $45;
11979  length abovetext $256;
11980  length tempstring origchar $64;
11981  if STAT in ("INTERVAL", "ORDINAL") then do;
11982  if first.parent then do;
11983  if missing(character_value) then do;
11984  numeric_value = round(numeric_value, 0.0001);
11985  abovetext = "< "||strip(NUMERIC_VALUE);
11986  branch = 1;
11987  origval = numeric_value;
11988  output;
11989  end;
11990  else do;
11991  abovetext = "< "||strip(CHARACTER_VALUE);
11992  branch = 1;
11993  origchar = character_value;
11994  output;
11995  end;
11996  if first.parent AND last.parent then do;
11997  if missing(character_value) then do;
11998  numeric_value = round(numeric_value, 0.0001);
11999  branch = branch + 1;
12000  abovetext = ">= "||strip(NUMERIC_VALUE);
12001  output;
12002  end;
12003  else do;
12004  branch = branch + 1;
12005  abovetext = ">= "||strip(CHARACTER_VALUE);
12006  output;
12007  end;
12008  end;
12009  end;
12010  else if last.parent then do;
12011  if ( missing(character_value) AND (origval ne numeric_value)) or ( ^missing(character_value) AND (origchar ne character_value)) then do;
12012  if missing(character_value) then do;
12013  numeric_value = round(numeric_value, 0.0001);
12014  abovetext= "[ "||strip(origval)||", "|| strip(numeric_value)||" )";
12015  end;
12016  else do;
12017  abovetext= ">= "||strip(origchar)||" AND < "|| strip(character_value);
12018  end;
12019  branch = branch + 1;
12020  output;
12021  if missing(character_value) then do;
12022  numeric_value = round(numeric_value, 0.0001);
12023  abovetext = ">= "||strip(NUMERIC_VALUE);
12024  end;
12025  else do;
12026  abovetext = ">= "||strip(CHARACTER_VALUE);
12027  end;
12028  branch = branch + 1;
12029  output;
12030  end;
12031  else do;
12032  if missing(character_value) then do;
12033  numeric_value = round(numeric_value, 0.0001);
12034  abovetext = ">= "||strip(NUMERIC_VALUE);
12035  end;
12036  else do;
12037  abovetext = ">= "||strip(CHARACTER_VALUE);
12038  end;
12039  branch = branch + 1;
12040  output;
12041  end;
12042  end;
12043  else do;
12044  if ( missing(character_value) AND (origval ne numeric_value)) or ( ^missing(character_value) AND (origchar ne character_value)) then do;
12045  if missing(character_value) then do;
12046  numeric_value = round(numeric_value,0.0001);
12047  abovetext= "[ "||strip(origval)||", "|| strip(numeric_value)||" )";
12048  origval = numeric_value;
12049  end;
12050  else do;
12051  abovetext= ">= "||strip(origchar)||" AND < "|| strip(character_value);
12052  origchar = character_value;
12053  end;
12054  branch = branch + 1;
12055  output;
12056  end;
12057  else do;
12058  if missing(character_value) then do;
12059  numeric_value = round(numeric_value, 0.0001);
12060  abovetext = ">= "||strip(NUMERIC_VALUE);
12061  origval = numeric_value;
12062  end;
12063  else do;
12064  abovetext = ">= "||strip(CHARACTER_VALUE);
12065  origval = character_value;
12066  end;
12067  branch = branch + 1;
12068  output;
12069  end;
12070  end;
12071  end;
12072  else do;
12073  if first.numeric_value then do;
12074  flag = 0;
12075  abovetext = CHARACTER_VALUE;
12076  branch = numeric_value;
12077  if first.numeric_value AND last.numeric_value then do;
12078  output;
12079  end;
12080  end;
12081  else if last.numeric_value then do;
12082  if flag=0 then do;
12083  tempstring = strip(abovetext)||", "||CHARACTER_VALUE;
12084  length = length(strip(tempstring));
12085  if length < 32 then do;
12086  abovetext = strip(tempstring);
12087  end;
12088  else do;
12089  abovetext = strip(abovetext)||", ...";
12090  flag = 1;
12091  end;
12092  end;
12093  branch = numeric_value;
12094  output;
12095  end;
12096  else do;
12097  if flag=0 then do;
12098  tempstring = strip(abovetext)||", "||CHARACTER_VALUE;
12099  length = length(strip(tempstring));
12100  if length < 32 then do;
12101  abovetext = strip(tempstring);
12102  end;
12103  else do;
12104  abovetext = strip(abovetext)||", ...";
12105  flag=1;
12106  end;
12107  end;
12108  branch = numeric_value;
12109  end;
12110  end;
12111  keep parent branch abovetext;
12112  run;
 
NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      11985:25   12000:26   12014:24   12014:47   12023:26   12034:26   12047:24   12047:47   12060:26
NOTE: Character values have been converted to numeric values at the places given by: (Line):(Column).
      12065:11
NOTE: There were 4 observations read from the data set WORK.TEMPOUTRULES.
NOTE: The data set WORK.TEMPABOVE has 8 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12113  /* MIssing value to abovetext */
12114  data tempmissing;
12115  set WORK.OUTRULES_TREE_2RTAMS3;
12116  if ((ROLE="PRIMARY") AND (STAT in ("MISSING")));
12117  rename node=parent numeric_value=branch character_value=misschar;
12118  run;
 
NOTE: There were 104 observations read from the data set WORK.OUTRULES_TREE_2RTAMS3.
NOTE: The data set WORK.TEMPMISSING has 4 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12119  proc sort data=work.tempabove;
12120  by parent branch;
12121  run;
 
NOTE: There were 8 observations read from the data set WORK.TEMPABOVE.
NOTE: The data set WORK.TEMPABOVE has 8 observations and 3 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12122  proc sort data=EMWS2.Clus_OUTNODES out=tempoutnodes;
12123  by parent branch;
12124  run;
 
NOTE: There were 9 observations read from the data set EMWS2.CLUS_OUTNODES.
NOTE: The data set WORK.TEMPOUTNODES has 9 observations and 22 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12125  proc sort data=tempmissing;
12126  by parent branch;
12127  run;
 
NOTE: There were 4 observations read from the data set WORK.TEMPMISSING.
NOTE: The data set WORK.TEMPMISSING has 4 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12128  data WORK.Clus_outnodes;
12129  merge work.tempabove tempoutNodes(drop=abovetext ) tempmissing(in=_a);
12130  by parent branch;
12131  length traintotal validtotal 8;
12132  retain traintotal validtotal;
12133  if _a then do;
12134  if ^MISSING(abovetext) then do;
12135  abovetext= strip(abovetext)||" %sysfunc(sasmsg(sashelp.dmine, tree_ormiss_vlabel, noquote))";
12136  end;
12137  else do;
12138  abovetext = " %sysfunc(sasmsg(sashelp.dmine, tree_missonly_vlabel, noquote))";
12139  end;
12140  end;
12141  if MISSING(abovetext) then abovetext="%sysfunc(sasmsg(sashelp.dmine, tree_nonmiss_vlabel, noquote))";
12142  if node=1 then do;
12143  traintotal = N;
12144  validtotal=VN;
12145  end;
12146  label traintotal = "%sysfunc(sasmsg(sashelp.dmine,  rpt_traintotal_vlabel, noquote))";
12147  drop role rank stat misschar belowtext;
12148  run;
 
NOTE: Variable VN is uninitialized.
NOTE: There were 8 observations read from the data set WORK.TEMPABOVE.
NOTE: There were 9 observations read from the data set WORK.TEMPOUTNODES.
NOTE: There were 4 observations read from the data set WORK.TEMPMISSING.
NOTE: The data set WORK.CLUS_OUTNODES has 9 observations and 24 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
 
 
12149  proc sort data=WORK.Clus_outnodes;
12150  by node;
12151  run;
 
NOTE: There were 9 observations read from the data set WORK.CLUS_OUTNODES.
NOTE: The data set WORK.CLUS_OUTNODES has 9 observations and 24 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12152  proc sort data=tempbelow;
12153  by node;
12154  run;
 
NOTE: Input data set is already sorted, no sorting done.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12155  data WORK.Clus_outnodes;
12156  merge WORK.Clus_outnodes tempbelow;
12157  by node;
12158  run;
 
NOTE: There were 9 observations read from the data set WORK.CLUS_OUTNODES.
NOTE: There were 4 observations read from the data set WORK.TEMPBELOW.
NOTE: The data set WORK.CLUS_OUTNODES has 9 observations and 25 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
 
 
NOTE: There were 28401 observations read from the data set AAEM61.DTSTOCK_TRAIN.
NOTE: There were 28401 observations read from the data set EMWS2.IDS3_DATA.
NOTE: There were 27816 observations read from the data set EMWS2.FILTER_TRAIN.
NOTE: View EMWS2.EM_CLUS.VIEW used (Total process time):
      real time           0.13 seconds
      cpu time            0.14 seconds
 
NOTE: There were 27816 observations read from the data set EMWS2.CLUS_TRAIN.
12159  data tempoutstats;
12160  set WORK.OUTSTATS_TREE_2RTAMS3;
12161  length tarlevel $8;
12162  tarlevel ="NOMINAL";
12163  run;
 
NOTE: There were 45 observations read from the data set WORK.OUTSTATS_TREE_2RTAMS3.
NOTE: The data set WORK.TEMPOUTSTATS has 45 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12164  data EMWS2.Clus_TREE_PLOT;
12165  length NODETEXT TEXTALL $800 N NODECOLOR 8;
12166  set WORK.Clus_outnodes;
12167  label parent = "%sysfunc(sasmsg(sashelp.dmine, rpt_parentID_vlabel, noquote))" depth = "%sysfunc(sasmsg(sashelp.dmine, rpt_depth_vlabel, noquote))" belowtext= "%sysfunc(sasmsg(sashelp.dmine, rpt_belowtext_vlabel, noquote))" abovetext =
12168     "%sysfunc(sasmsg(sashelp.dmine, rpt_abovetext_vlabel, noquote))" linkwidth = "%sysfunc(sasmsg(sashelp.dmine, rpt_linkwidth_vlabel, noquote))" nodetext = "%sysfunc(sasmsg(sashelp.dmine, rpt_nodetext_vlabel, noquote))" textall =
12169     "%sysfunc(sasmsg(sashelp.dmine, rpt_textall_vlabel, noquote))" N = "%sysfunc(sasmsg(sashelp.dmine, rpt_trainn_vlabel, noquote))" nodecolor = "%sysfunc(sasmsg(sashelp.dmine, rpt_nodecolor_vlabel, noquote))" node =
12170     "%sysfunc(sasmsg(sashelp.dmine, rpt_node_vlabel, noquote))";
12171  keep NODE PARENT DEPTH BELOWTEXT ABOVETEXT LINKWIDTH NODETEXT TEXTALL N NODECOLOR;
12172  run;
 
NOTE: Variable TEXTALL is uninitialized.
NOTE: Variable NODECOLOR is uninitialized.
NOTE: There were 9 observations read from the data set WORK.CLUS_OUTNODES.
NOTE: The data set EMWS2.CLUS_TREE_PLOT has 9 observations and 10 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
 
 
12173  proc sort data=EMWS2.Clus_TREE_PLOT;
12174  by node;
12175  run;
 
NOTE: There were 9 observations read from the data set EMWS2.CLUS_TREE_PLOT.
NOTE: The data set EMWS2.CLUS_TREE_PLOT has 9 observations and 10 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
 
 
12176  proc sort data=tempoutstats;
12177  by node;
12178  run;
 
NOTE: There were 45 observations read from the data set WORK.TEMPOUTSTATS.
NOTE: The data set WORK.TEMPOUTSTATS has 45 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12179  data EMWS2.Clus_TREE_PLOT;
12180  merge EMWS2.Clus_TREE_PLOT tempoutstats;
12181  length text $800 _RASE_ P__SEGMENT_1 8;
12182  retain P__SEGMENT_1 eventlevel;
12183  by node;
12184  if statname='N' then N=statvalue;
12185  if statname='NPRIORS' then N=statvalue;
12186  if statname='PREDICTION' then eventlevel=category;
12187  _RASE_ = .;
12188  if tarlevel ^= 'INTERVAL' then do;
12189  if STATNAME = 'PROBABILITY' then do;
12190  if CATEGORY=EVENTLEVEL then do;
12191  nodetext = right(put(strip(CATEGORY)||':', $12.))|| right(put(STATVALUE, percent13.1));
12192  text = right(put(strip(CATEGORY)||':', $12.))|| right(put(STATVALUE, percent13.1));
12193  P__SEGMENT_1 = round(STATVALUE, .01);
12194  end;
12195  else do;
12196  text = right(put(strip(CATEGORY)||':', $12.))|| right(put(STATVALUE, percent13.1));
12197  end;
12198  textall = strip(textall)||'0A'x||strip( text);
12199  end;
12200  if last.node then do;
12201  nodetext = trim(nodetext)||'0A'x||" %sysfunc(sasmsg(sashelp.dmine, rpt_rptcount_vlabel, noquote )):"|| put(N, 13.);
12202  textall = trim(textall)||'0A'x||" %sysfunc(sasmsg(sashelp.dmine, rpt_rptcount_vlabel, noquote )):"|| put(N, 13.);
12203  output EMWS2.Clus_TREE_PLOT;
12204  end;
12205  end;
12206  else do;
12207  if statname='RASE' then _RASE_=statvalue;
12208  label _RASE_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_trase_vlabel, noquote))";
12209  if STATNAME = 'PREDICTION' then do;
12210  nodetext= "%sysfunc(sasmsg(sashelp.dmine, rpt_average_vlabel, noquote))"|| put(STATVALUE, 13.4)||'0A'x|| "%sysfunc(sasmsg(sashelp.dmine, rpt_rptcount_vlabel, noquote )):"|| put(N, 13.);
12211  textall = nodetext;
12212  P__SEGMENT_1 = STATVALUE;
12213  ;
12214  ;
12215  end;
12216  if last.node then do;
12217  output EMWS2.Clus_TREE_PLOT;
12218  end;
12219  ;
12220  end;
12221  label P__SEGMENT_1 = "%sysfunc(sasmsg(sashelp.dmine, rpt_predictedvar_vlabel, noquote))";
12222  keep NODE PARENT DEPTH BELOWTEXT ABOVETEXT LINKWIDTH NODETEXT TEXTALL N NODECOLOR _RASE_ P__SEGMENT_1;
12223  run;
 
NOTE: There were 9 observations read from the data set EMWS2.CLUS_TREE_PLOT.
NOTE: There were 45 observations read from the data set WORK.TEMPOUTSTATS.
NOTE: The data set EMWS2.CLUS_TREE_PLOT has 9 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12224  data tempcolor;
12225  set WORK.OUTSTATS_TREE_2RTAMS3;
12226  retain eventlevel;
12227  if STATNAME='PREDICTION' then eventlevel=CATEGORY;
12228  run;
 
NOTE: There were 45 observations read from the data set WORK.OUTSTATS_TREE_2RTAMS3.
NOTE: The data set WORK.TEMPCOLOR has 45 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12229  data tempcolor;
12230  set tempcolor;
12231  if 'NOMINAL' ne 'INTERVAL' then do;
12232  if CATEGORY=EVENTLEVEL AND STATNAME="PROBABILITY";
12233  end;
12234  else do;
12235  if STATNAME="PREDICTION";
12236  end;
12237  run;
 
NOTE: There were 45 observations read from the data set WORK.TEMPCOLOR.
NOTE: The data set WORK.TEMPCOLOR has 9 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12238  data tempcolor;
12239  set tempcolor;
12240  length nodecolor 8;
12241  if 'NOMINAL' ne 'INTERVAL' then do;
12242  nodecolor = round(100*(STATVALUE), .01);
12243  end;
12244  else do;
12245  nodecolor=round(statvalue, .01);
12246  end;
12247  keep node nodecolor;
12248  run;
 
NOTE: There were 9 observations read from the data set WORK.TEMPCOLOR.
NOTE: The data set WORK.TEMPCOLOR has 9 observations and 2 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12249  proc sort data=EMWS2.Clus_TREE_PLOT;
12250  by node;
12251  run;
 
NOTE: There were 9 observations read from the data set EMWS2.CLUS_TREE_PLOT.
NOTE: The data set EMWS2.CLUS_TREE_PLOT has 9 observations and 12 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12252  proc sort data=tempcolor;
12253  by node;
12254  run;
 
NOTE: There were 9 observations read from the data set WORK.TEMPCOLOR.
NOTE: The data set WORK.TEMPCOLOR has 9 observations and 2 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12255  data EMWS2.Clus_TREE_PLOT;
12256  merge EMWS2.Clus_TREE_PLOT tempcolor;
12257  by node;
12258  length traintotal 8;
12259  retain traintotal;
12260  label traintotal = "%sysfunc(sasmsg(sashelp.dmine,  rpt_traintotal_vlabel, noquote))";
12261  if node=1 then do;
12262  traintotal = N;
12263  end;
12264  if NODE eq . then delete;
12265  run;
 
NOTE: There were 9 observations read from the data set EMWS2.CLUS_TREE_PLOT.
NOTE: There were 9 observations read from the data set WORK.TEMPCOLOR.
NOTE: The data set EMWS2.CLUS_TREE_PLOT has 9 observations and 13 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12266  data EMWS2.Clus_TREE_PLOT;
12267  set EMWS2.Clus_TREE_PLOT;
12268  textall = "%sysfunc(sasmsg(sashelp.dmine, rpt_nodeId_vlabel, noquote, )):"|| put(Node, 13.)||'0A'x||trim(textall);
12269  run;
 
NOTE: There were 9 observations read from the data set EMWS2.CLUS_TREE_PLOT.
NOTE: The data set EMWS2.CLUS_TREE_PLOT has 9 observations and 13 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
 
 
12270  data tempout;
12271  set WORK.Clus_outnodes;
12272  run;
 
NOTE: There were 9 observations read from the data set WORK.CLUS_OUTNODES.
NOTE: The data set WORK.TEMPOUT has 9 observations and 25 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12273  proc sort data=tempout;
12274  by descending P__SEGMENT_1;
12275  run;
 
NOTE: There were 9 observations read from the data set WORK.TEMPOUT.
NOTE: The data set WORK.TEMPOUT has 9 observations and 25 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
 
 
12276  data tree_temp;
12277  set tempout;
12278  if LEAF ne .;
12279  label index="%sysfunc(sasmsg(sashelp.dmine, rpt_leafindex_vlabel  , NOQUOTE))";
12280  label percevent_train = "%sysfunc(sasmsg(sashelp.dmine, rpt_perc_train_vlabel  , NOQUOTE))";
12281  label perc_train = "%sysfunc(sasmsg(sashelp.dmine, rpt_percevent_train_vlabel  , NOQUOTE))";
12282  label tprob="%sysfunc(sasmsg(sashelp.dmine, rpt_prob_vlabel  , NOQUOTE, %nrbquote()))";
12283  tprob = round(P__SEGMENT_1, .01);
12284  percevent_train = round ( tprob*100, .01);
12285  *perc_train =round( ( N / traintotal)*100, .001);
12286  perc_train =round( ( N / traintotal), .01);
12287  if missing(perc_train) then perc_train = round( linkwidth*100, .001);
12288  index = _n_;
12289  keep NODE index tprob perc_train percevent_train
12290  ;
12291  run;
 
NOTE: There were 9 observations read from the data set WORK.TEMPOUT.
NOTE: The data set WORK.TREE_TEMP has 5 observations and 5 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12292  proc sort data=tree_temp;
12293  by NODE;
12294  run;
 
NOTE: There were 5 observations read from the data set WORK.TREE_TEMP.
NOTE: The data set WORK.TREE_TEMP has 5 observations and 5 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12295  proc sort data=EMWS2.Clus_TREE_PLOT;
12296  by NODE;
12297  run;
 
NOTE: There were 9 observations read from the data set EMWS2.CLUS_TREE_PLOT.
NOTE: The data set EMWS2.CLUS_TREE_PLOT has 9 observations and 13 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12298  data EMWS2.Clus_TREE_PLOT;
12299  merge EMWS2.Clus_TREE_PLOT tree_temp;
12300  by NODE;
12301  run;
 
NOTE: There were 9 observations read from the data set EMWS2.CLUS_TREE_PLOT.
NOTE: There were 5 observations read from the data set WORK.TREE_TEMP.
NOTE: The data set EMWS2.CLUS_TREE_PLOT has 9 observations and 17 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12302  proc sort data=EMWS2.Clus_TREE_PLOT;
12303  by node index;
12304  run;
 
NOTE: There were 9 observations read from the data set EMWS2.CLUS_TREE_PLOT.
NOTE: The data set EMWS2.CLUS_TREE_PLOT has 9 observations and 17 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12305  title9 ' ';
12306  title10 "%sysfunc(sasmsg(sashelp.dmine, rpt_VariableImportance_title, NOQUOTE))";
12307  proc print data=EMWS2.Clus_OUTIMPORT(where=(IMPORTANCE>0)) noobs label;
12308  run;
 
NOTE: There were 5 observations read from the data set EMWS2.CLUS_OUTIMPORT.
      WHERE IMPORTANCE>0;
NOTE: The PROCEDURE PRINT printed page 4.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12309  title10;
 
12310  data WORK.M2X029AD;
12311  set WORK.M2X029AD;
12312  if role eq 'REJECTED' then role = 'INPUT';
12313  run;
 
NOTE: There were 8 observations read from the data set WORK.M2X029AD.
NOTE: The data set WORK.M2X029AD has 8 observations and 21 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12314  proc sort data=EMWS2.Clus_OUTIMPORT out=WORK.Clus_GRAPHVARS(keep=NAME);
12315  where IMPORTANCE>0;
12316  by NAME;
12317  run;
 
NOTE: There were 5 observations read from the data set EMWS2.CLUS_OUTIMPORT.
      WHERE IMPORTANCE>0;
NOTE: The data set WORK.CLUS_GRAPHVARS has 5 observations and 1 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12318  proc sort data = WORK.M2X029AD;
12319  by NAME;
12320  run;
 
NOTE: There were 8 observations read from the data set WORK.M2X029AD.
NOTE: The data set WORK.M2X029AD has 8 observations and 21 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
 
 
12321  data WORK.M2X029AD;
12322  merge WORK.M2X029AD WORK.Clus_GRAPHVARS(in=_b_);
12323  by NAME;
12324  if _b_ or ROLE = "FREQ" or REPORT="Y" then output;
12325  run;
 
NOTE: There were 8 observations read from the data set WORK.M2X029AD.
NOTE: There were 5 observations read from the data set WORK.CLUS_GRAPHVARS.
NOTE: The data set WORK.M2X029AD has 5 observations and 21 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12326  data WORK.M2X029AD;
12327  set WORK.M2X029AD end=_eof_ nobs=_nobs_;
12328  output;
12329  if _eof_ then do;
12330  name = '_SEGMENT_';
12331  ROLE = 'BY';
12332  LEVEL = 'NOMINAL';
12333  LABEL = 'Segment Variable';
12334  TYPE = 'N';
12335  FORMAT = '';
12336  INFORMAT = '';
12337  output;
12338  end;
12339  run;
 
NOTE: There were 5 observations read from the data set WORK.M2X029AD.
NOTE: The data set WORK.M2X029AD has 6 observations and 21 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
 
 
12340  *------------------------------------------------------------* ;
12341  * Clus: STDIZE Variables Macro ;
12342  *------------------------------------------------------------* ;
12343  %macro stdizevar;
12344      close high low open vol
12345  %mend stdizevar;
12346  *------------------------------------------------------------*;
12347  * Clus: Computing Summary Statistics;
12348  *------------------------------------------------------------*;
12349  proc stdize
12350  data = EMWS2.Clus_TRAIN
12351  out=_null_
12352  outstat=WORK.Clus_STAT
12353  add=0 fuzz=1E-14 initial=MAD
12354  vardef=df
12355  method=STD
12356  mult=1
12357  pctlmtd=ORD_STAT pctldef=2
12358  pctlpts=(
12359  0
12360  100
12361  )
12362  ;
12363  var %stdizevar;
12364  run;
 
NOTE: INITIAL= will be ignored.
NOTE: There were 28401 observations read from the data set AAEM61.DTSTOCK_TRAIN.
NOTE: There were 28401 observations read from the data set EMWS2.IDS3_DATA.
NOTE: View EMWS2.CLUS_TRAIN.VIEW used (Total process time):
      real time           0.11 seconds
      cpu time            0.12 seconds
 
NOTE: There were 27816 observations read from the data set EMWS2.FILTER_TRAIN.
NOTE: There were 27816 observations read from the data set EMWS2.CLUS_TRAIN.
NOTE: The data set WORK.CLUS_STAT has 10 observations and 6 variables.
NOTE: PROCEDURE STDIZE used (Total process time):
      real time           0.13 seconds
      cpu time            0.14 seconds
 
 
12365  quit;
 
12366  data WORK.Clus_MINMAX;
12367  set WORK.Clus_STAT;
12368  where _TYPE_ in('P0','P100');
12369  if _TYPE_='P0' then _TYPE_='MIN';
12370  else if _TYPE_='P100' then _TYPE_='MAX';
12371  run;
 
NOTE: There were 2 observations read from the data set WORK.CLUS_STAT.
      WHERE _TYPE_ in ('P0', 'P100');
NOTE: The data set WORK.CLUS_MINMAX has 2 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
 
 
12372  proc transpose data=WORK.Clus_MINMAX out=WORK.Clus_MINMAX(drop=_LABEL_ rename=(_NAME_=_VARIABLE_));
12373  id _TYPE_;
12374  run;
 
WARNING: The variable _LABEL_ in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 2 observations read from the data set WORK.CLUS_MINMAX.
NOTE: The data set WORK.CLUS_MINMAX has 5 observations and 3 variables.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
 
 
12375  data WORK.Clus_UGRID;
12376  set WORK.Clus_MINMAX;
12377  B1 = MIN + (1-1)*(MAX-MIN)/8;
12378  B2 = MIN + (2-1)*(MAX-MIN)/8;
12379  B3 = MIN + (3-1)*(MAX-MIN)/8;
12380  B4 = MIN + (4-1)*(MAX-MIN)/8;
12381  B5 = MIN + (5-1)*(MAX-MIN)/8;
12382  B6 = MIN + (6-1)*(MAX-MIN)/8;
12383  B7 = MIN + (7-1)*(MAX-MIN)/8;
12384  B8 = MIN + (8-1)*(MAX-MIN)/8;
12385  B9 = MIN + (9-1)*(MAX-MIN)/8;
12386  drop MIN MAX;
12387  run;
 
NOTE: There were 5 observations read from the data set WORK.CLUS_MINMAX.
NOTE: The data set WORK.CLUS_UGRID has 5 observations and 10 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
 
 
12388  *------------------------------------------------------------*;
12389  * Clus: Creating formats for binning interval variables;
12390  *------------------------------------------------------------*;
12391  proc format;
12392  value F1_
12393  0.005-2.454375 = "0.005:2.4544"
12394  2.454375-4.90375 = "2.4544:4.9038"
12395  4.90375-7.353125 = "4.9038:7.3531"
12396  7.353125-9.8025 = "7.3531:9.8025"
12397  9.8025-12.251875 = "9.8025:12.252"
12398  12.251875-14.70125 = "12.252:14.701"
12399  14.70125-17.150625 = "14.701:17.151"
12400  17.150625-19.6 = "17.151:19.6"
12401  ;
NOTE: Format F1_ has been output.
12402  value F2_
12403  0-2.4525 = "0:2.4525"
12404  2.4525-4.905 = "2.4525:4.905"
12405  4.905-7.3575 = "4.905:7.3575"
12406  7.3575-9.81 = "7.3575:9.81"
12407  9.81-12.2625 = "9.81:12.263"
12408  12.2625-14.715 = "12.263:14.715"
12409  14.715-17.1675 = "14.715:17.168"
12410  17.1675-19.62 = "17.168:19.62"
12411  ;
NOTE: Format F2_ has been output.
12412  value F3_
12413  0-2.43 = "0:2.43"
12414  2.43-4.86 = "2.43:4.86"
12415  4.86-7.29 = "4.86:7.29"
12416  7.29-9.72 = "7.29:9.72"
12417  9.72-12.15 = "9.72:12.15"
12418  12.15-14.58 = "12.15:14.58"
12419  14.58-17.01 = "14.58:17.01"
12420  17.01-19.44 = "17.01:19.44"
12421  ;
NOTE: Format F3_ has been output.
12422  value F4_
12423  0-2.435 = "0:2.435"
12424  2.435-4.87 = "2.435:4.87"
12425  4.87-7.305 = "4.87:7.305"
12426  7.305-9.74 = "7.305:9.74"
12427  9.74-12.175 = "9.74:12.175"
12428  12.175-14.61 = "12.175:14.61"
12429  14.61-17.045 = "14.61:17.045"
12430  17.045-19.48 = "17.045:19.48"
12431  ;
NOTE: Format F4_ has been output.
12432  value F5_
12433  0-44001.75 = "0:44002"
12434  44001.75-88003.5 = "44002:88004"
12435  88003.5-132005.25 = "88004:132005"
12436  132005.25-176007 = "132005:176007"
12437  176007-220008.75 = "176007:220009"
12438  220008.75-264010.5 = "220009:264011"
12439  264010.5-308012.25 = "264011:308012"
12440  308012.25-352014 = "308012:352014"
12441  ;
NOTE: Format F5_ has been output.
12442  run;
 
NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12443  ods listing close;
12444  ods output crosstabfreqs=WORK.TEMPFREQ;
12445  proc freq data = EMWS2.Clus_TRAIN order=formatted addnames;
12446  table close * _SEGMENT_ / missing;
12447  table high * _SEGMENT_ / missing;
12448  table low * _SEGMENT_ / missing;
12449  table open * _SEGMENT_ / missing;
12450  table vol * _SEGMENT_ / missing;
12451  format CLOSE F1_.;
12452  format HIGH F2_.;
12453  format LOW F3_.;
12454  format OPEN F4_.;
12455  format VOL F5_.;
12456  run;
 
NOTE: There were 28401 observations read from the data set AAEM61.DTSTOCK_TRAIN.
NOTE: There were 28401 observations read from the data set EMWS2.IDS3_DATA.
NOTE: View EMWS2.CLUS_TRAIN.VIEW used (Total process time):
      real time           0.13 seconds
      cpu time            0.09 seconds
 
NOTE: There were 27816 observations read from the data set EMWS2.FILTER_TRAIN.
NOTE: The data set WORK.TEMPFREQ has 180 observations and 16 variables.
NOTE: There were 27816 observations read from the data set EMWS2.CLUS_TRAIN.
NOTE: PROCEDURE FREQ used (Total process time):
      real time           0.15 seconds
      cpu time            0.09 seconds
 
 
12457  quit;
12458  ods listing;
12459  data EMWS2.Clus_PROFILE(keep=_VARIABLE_ _SEGMENT_ TYPE COUNT PERCENT _X_ _XLABEL_);
12460  label _VARIABLE_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_variable_vlabel, NOQUOTE))" _SEGMENT_ = "Segment Variable" Type = "%sysfunc(sasmsg(sashelp.dmine, rpt_type_vlabel,         NOQUOTE))" _X_ =
12461     "%sysfunc(sasmsg(sashelp.dmine, rpt_numValue_vlabel, NOQUOTE))" _XLABEL_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_fmtValue_vlabel ,    NOQUOTE))" COUNT = "%sysfunc(sasmsg(sashelp.dmine, rpt_count_vlabel,        NOQUOTE))" PERCENT =
12462     "%sysfunc(sasmsg(sashelp.dmine, rpt_percent_vlabel,      NOQUOTE))";
12463  dsid = open("WORK.TEMPFREQ");
12464  varnum = varnum(dsid, 'ROWVARIABLE');
12465  freqnum = varnum(dsid, 'FREQUENCY');
12466  pvarnum = varnum(dsid, 'PERCENT');
12467  typenum = varnum(dsid, '_TYPE_');
12468  bynum = varnum(dsid, "_SEGMENT_");
12469  length varformat _VARIABLE_ $32 _XLABEL_ $32 TYPE $1;
12470  do while(^fetch(dsid));
12471  count = getvarn(dsid, freqnum);
12472  percent = getvarn(dsid, pvarnum);
12473  _VARIABLE_ = strip(getvarc(dsid, varnum));
12474  varblnum = varnum(dsid, _VARIABLE_);
12475  _SEGMENT_ = getvarn(dsid, bynum);
12476  type = vartype(dsid, varblnum);
12477  varformat = varfmt(dsid, varblnum);
12478  if varformat eq '' then varformat = 'best12.';
12479  _X_=.;
12480  if type = 'N' then do;
12481  _X_ = getvarn(dsid, varblnum);
12482  _XLABEL_ = left(putn(_X_, varformat));
12483  end;
12484  else _XLABEL_ = getvarc(dsid, varblnum);
12485  if getvarc(dsid, typenum) = '11' then output;
12486  end;
12487  dsid = close(dsid);
12488  run;
 
NOTE: The data set EMWS2.CLUS_PROFILE has 120 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12489  proc sort data=EMWS2.Clus_PROFILE NOTHREADS;
12490  by _VARIABLE_ _SEGMENT_;
12491  run;
 
NOTE: There were 120 observations read from the data set EMWS2.CLUS_PROFILE.
NOTE: The data set EMWS2.CLUS_PROFILE has 120 observations and 7 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12492  proc means data=EMWS2.Clus_PROFILE noprint missing NWAY;
12493  class _VARIABLE_ _SEGMENT_;
12494  var COUNT;
12495  output out=WORK.Clus_STATCOUNT(keep=_SEGMENT_ _VARIABLE_ SUM) SUM=SUM;
12496  run;
 
NOTE: There were 120 observations read from the data set EMWS2.CLUS_PROFILE.
NOTE: The data set WORK.CLUS_STATCOUNT has 15 observations and 3 variables.
NOTE: PROCEDURE MEANS used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12497  proc sort data=WORK.Clus_STATCOUNT NOTHREADS;
12498  by _VARIABLE_ _SEGMENT_;
12499  run;
 
NOTE: There were 15 observations read from the data set WORK.CLUS_STATCOUNT.
NOTE: The data set WORK.CLUS_STATCOUNT has 15 observations and 3 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12500  data EMWS2.Clus_PROFILE(drop=SUM);
12501  label BYPERCENT= "%sysfunc(sasmsg(sashelp.dmine, rpt_percent_vlabel, NOQUOTE, _SEGMENT_))";
12502  merge EMWS2.Clus_PROFILE WORK.Clus_STATCOUNT;
12503  by _VARIABLE_ _SEGMENT_;
12504  if SUM ne . then BYPERCENT = 100*COUNT/SUM;
12505  run;
 
NOTE: There were 120 observations read from the data set EMWS2.CLUS_PROFILE.
NOTE: There were 15 observations read from the data set WORK.CLUS_STATCOUNT.
NOTE: The data set EMWS2.CLUS_PROFILE has 120 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12506  proc sort data=EMWS2.Clus_PROFILE NOTHREADS;
12507  by _VARIABLE_;
12508  run;
 
NOTE: There were 120 observations read from the data set EMWS2.CLUS_PROFILE.
NOTE: The data set EMWS2.CLUS_PROFILE has 120 observations and 8 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12509  proc sort data=WORK.M2X029AD;
12510  by Name;
12511  run;
 
NOTE: There were 6 observations read from the data set WORK.M2X029AD.
NOTE: The data set WORK.M2X029AD has 6 observations and 21 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12512  data EMWS2.Clus_PROFILE;
12513  merge EMWS2.Clus_PROFILE(in=_a) WORK.M2X029AD(keep=Name Label Role rename=(Name=_Variable_ Label=_Label_));
12514  by _Variable_;
12515  label Role = "%sysfunc(sasmsg(sashelp.dmine, meta_role_vlabel ,  NOQUOTE))";
12516  label Label = "%sysfunc(sasmsg(sashelp.dmine, meta_label_vlabel , NOQUOTE))";
12517  if _a then output;
12518  run;
 
NOTE: Variable Label is uninitialized.
WARNING: Multiple lengths were specified for the BY variable _VARIABLE_ by input data sets. This might cause unexpected results.
NOTE: There were 120 observations read from the data set EMWS2.CLUS_PROFILE.
NOTE: There were 6 observations read from the data set WORK.M2X029AD.
NOTE: The data set EMWS2.CLUS_PROFILE has 120 observations and 10 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
 
 
12519  proc sort data=EMWS2.Clus_PROFILE;
12520  by _SEGMENT_ _VARIABLE_ _X_;
12521  run;
 
NOTE: There were 120 observations read from the data set EMWS2.CLUS_PROFILE.
NOTE: The data set EMWS2.CLUS_PROFILE has 120 observations and 10 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12522  data EMWS2.Clus_PROFILE(rename=(_VARIABLE_=Variable _X_=NumericValue _XLABEL_=FmtValue));
12523  set EMWS2.Clus_PROFILE;
12524  retain orderedValue 0;
12525  label OrderedValue = "%sysfunc(sasmsg(sashelp.dmine, rpt_OrderedValue_vlabel, NOQUOTE))";
12526  by _SEGMENT_ _VARIABLE_;
12527  if first._variable_ then orderedValue=1;
12528  else orderedValue+1;
12529  run;
 
NOTE: There were 120 observations read from the data set EMWS2.CLUS_PROFILE.
NOTE: The data set EMWS2.CLUS_PROFILE has 120 observations and 11 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
 
 
12530  data WORK.Clus_temp;
12531  set EMWS2.Clus_OUTMEAN;
12532  _idvar_=left(put(_SEGMENT_,4.));
12533  run;
 
NOTE: There were 3 observations read from the data set EMWS2.CLUS_OUTMEAN.
NOTE: The data set WORK.CLUS_TEMP has 3 observations and 15 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12534  proc distance data=WORK.Clus_temp out=EMWS2.Clus_DISTANCE method=l(2) shape=square;
12535  id _idvar_;
12536  var interval(%dmvqvars);
12537  run;
 
NOTE: The data set EMWS2.CLUS_DISTANCE has 3 observations and 4 variables.
NOTE: PROCEDURE DISTANCE used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
 
 
12538  proc datasets lib=EMWS2 nolist;
12539  modify Clus_DISTANCE;
12540  rename _idvar_=_SEGMENT_;
NOTE: Renaming variable _idvar_ to _SEGMENT_.
12541  run;
 
NOTE: MODIFY was successful for EMWS2.CLUS_DISTANCE.DATA.
12542  quit;
 
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
 
 
12543  *------------------------------------------------------------*;
12544  * Clus: Creating data set for Input Mean report;
12545  *------------------------------------------------------------*;
12546  data temp(drop=_type_ over_all);
12547  set EMWS2.Clus_OUTSTAT;
12548  where _type_ in('DMDB_MEAN', 'CLUS_MEAN');
12549  run;
 
NOTE: There were 4 observations read from the data set EMWS2.CLUS_OUTSTAT.
      WHERE _type_ in ('CLUS_MEAN', 'DMDB_MEAN');
NOTE: The data set WORK.TEMP has 4 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12550  proc sort data=temp;
12551  by _SEGMENT_;
12552  run;
 
NOTE: There were 4 observations read from the data set WORK.TEMP.
NOTE: The data set WORK.TEMP has 4 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
 
 
12553  proc stdize data=temp out=stdtemp pctlpts=0 100 outstat=stat;
12554  var close--vol;
12555  run;
 
NOTE: There were 4 observations read from the data set WORK.TEMP.
NOTE: The data set WORK.STDTEMP has 4 observations and 6 variables.
NOTE: The data set WORK.STAT has 10 observations and 6 variables.
NOTE: PROCEDURE STDIZE used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
 
 
12556  proc transpose data=stat out=tstat(rename=(COL1=MEAN COL2=STD COL3=MIN COL4=MAX));
12557  where _type_ in ('LOCATION', 'SCALE','P0', 'P100');
12558  run;
 
NOTE: There were 4 observations read from the data set WORK.STAT.
      WHERE _type_ in ('LOCATION', 'P0', 'P100', 'SCALE');
NOTE: The data set WORK.TSTAT has 5 observations and 5 variables.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
 
 
12559  data tstat( rename=(_NAME_=NAME) keep=_NAME_ cv stdmin stdmax);
12560  set tstat;
12561  if std ^in (0, .) then do;
12562  stdmin = abs((min-mean)/std);
12563  stdmax = abs((max-mean)/std);
12564  end;
12565  if mean ^in(0, .) then cv = std/mean;
12566  run;
 
NOTE: There were 5 observations read from the data set WORK.TSTAT.
NOTE: The data set WORK.TSTAT has 5 observations and 4 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12567  proc sort data=tstat;
12568  by NAME;
12569  run;
 
NOTE: There were 5 observations read from the data set WORK.TSTAT.
NOTE: The data set WORK.TSTAT has 5 observations and 4 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12570  proc transpose data=stdtemp out=tstdtemp(rename=(_NAME_=NAME _LABEL_=LABEL COL1=MEAN));
12571  by _SEGMENT_;
12572  run;
 
WARNING: The variable _LABEL_ in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 4 observations read from the data set WORK.STDTEMP.
NOTE: The data set WORK.TSTDTEMP has 20 observations and 3 variables.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
 
 
12573  proc sort data=tstdtemp;
12574  by NAME;
12575  run;
 
NOTE: There were 20 observations read from the data set WORK.TSTDTEMP.
NOTE: The data set WORK.TSTDTEMP has 20 observations and 3 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12576  data tstdtemp;
12577  merge tstdtemp tstat;
12578  by NAME;
12579  STDMEAN = (MEAN + stdmin)/(stdmin + stdmax);
12580  drop stdmin stdmax mean;
12581  run;
 
NOTE: There were 20 observations read from the data set WORK.TSTDTEMP.
NOTE: There were 5 observations read from the data set WORK.TSTAT.
NOTE: The data set WORK.TSTDTEMP has 20 observations and 4 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12582  proc transpose data=EMWS2.Clus_OUTVAR out=tempVar(drop=_LABEL_ rename=( _NAME_=NAME VARIABLE=INPUT));
12583  var close--vol;
12584  id _type_;
12585  where _type_ = 'VARIABLE';
12586  run;
 
WARNING: The variable _LABEL_ in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 1 observations read from the data set EMWS2.CLUS_OUTVAR.
      WHERE _type_='VARIABLE';
NOTE: The data set WORK.TEMPVAR has 5 observations and 2 variables.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
 
 
12587  proc sort data=tempVar;
12588  by NAME;
12589  run;
 
NOTE: There were 5 observations read from the data set WORK.TEMPVAR.
NOTE: The data set WORK.TEMPVAR has 5 observations and 2 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
 
 
12590  data EMWS2.Clus_INPUTMEAN(rename=(NAME=VARIABLE));
12591  Length _SEGMENT_CHAR_ $7;
12592  label _SEGMENT_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_segmentName_vlabel,  NOQUOTE))" _SEGMENT_CHAR_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_segmentId_vlabel,    NOQUOTE))" NAME = "%sysfunc(sasmsg(sashelp.dmine, rpt_variable_vlabel,     NOQUOTE))"
12592! INPUT =
12593     "%sysfunc(sasmsg(sashelp.dmine, rpt_input_vlabel,        NOQUOTE))" LABEL = "%sysfunc(sasmsg(sashelp.dmine, rpt_label_vlabel,        NOQUOTE))" CV = "%sysfunc(sasmsg(sashelp.dmine, rpt_cv_vlabel,           NOQUOTE))" STDMEAN =
12594     "%sysfunc(sasmsg(sashelp.dmine, rpt_normmean_vlabel,     NOQUOTE))";
12595  merge tempvar tstdtemp;
12596  by NAME;
12597  if LABEL='' then LABEL=NAME;
12598  _SEGMENT_CHAR_ = strip(put(_SEGMENT_, best.));
12599  if _SEGMENT_ = . then _SEGMENT_CHAR_='Overall';
12600  run;
 
NOTE: There were 5 observations read from the data set WORK.TEMPVAR.
NOTE: There were 20 observations read from the data set WORK.TSTDTEMP.
NOTE: The data set EMWS2.CLUS_INPUTMEAN has 20 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12601  proc sort data=EMWS2.Clus_INPUTMEAN;
12602  by descending cv;
12603  run;
 
NOTE: There were 20 observations read from the data set EMWS2.CLUS_INPUTMEAN.
NOTE: The data set EMWS2.CLUS_INPUTMEAN has 20 observations and 7 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12604  *------------------------------------------------------------*;
12605  * Clus: Determining the important variables;
12606  *------------------------------------------------------------*;
 
12607  %let _nobs = 0;
12608  data keepvars(rename=(NAME=INPUT));
12609  set EMWS2.Clus_OUTIMPORT(where=(IMPORTANCE>0.5)) end=eof;
12610  if eof then call symput('_nobs', strip(put(_N_, best.)));
12611  run;
 
NOTE: There were 5 observations read from the data set EMWS2.CLUS_OUTIMPORT.
      WHERE IMPORTANCE>0.5;
NOTE: The data set WORK.KEEPVARS has 5 observations and 5 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
 
 
12612  proc transpose data=EMWS2.Clus_OUTVAR out=tempVar(drop=_LABEL_ rename=( _NAME_=NAME VARIABLE=INPUT));
12613  var close--vol;
12614  id _type_;
12615  where _type_ = 'VARIABLE';
12616  run;
 
WARNING: The variable _LABEL_ in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 1 observations read from the data set EMWS2.CLUS_OUTVAR.
      WHERE _type_='VARIABLE';
NOTE: The data set WORK.TEMPVAR has 5 observations and 2 variables.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.02 seconds
      cpu time            0.00 seconds
 
 
12617  proc sort data=keepvars;
12618  by INPUT;
12619  run;
 
NOTE: There were 5 observations read from the data set WORK.KEEPVARS.
NOTE: The data set WORK.KEEPVARS has 5 observations and 5 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
 
 
12620  proc sort data=tempvar;
12621  by INPUT;
12622  run;
 
NOTE: There were 5 observations read from the data set WORK.TEMPVAR.
NOTE: The data set WORK.TEMPVAR has 5 observations and 2 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12623  data vars;
12624  merge tempvar keepvars(in=b);
12625  by INPUT;
12626  if b then output;
12627  run;
 
WARNING: Multiple lengths were specified for the BY variable INPUT by input data sets. This might cause unexpected results.
NOTE: There were 5 observations read from the data set WORK.TEMPVAR.
NOTE: There were 5 observations read from the data set WORK.KEEPVARS.
NOTE: The data set WORK.VARS has 5 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
 
 
12628  proc sort data=vars;
12629  by descending importance;
12630  run;
 
NOTE: There were 5 observations read from the data set WORK.VARS.
NOTE: The data set WORK.VARS has 5 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12631  data _null_;
12632  set vars;
12633  if _N_=1 then call symput('CLUS_PROFVARS', strip(NAME));
12634  else call symput('CLUS_PROFVARS',symget('CLUS_PROFVARS')!!' '!!strip(NAME));
12635  run;
 
NOTE: There were 5 observations read from the data set WORK.VARS.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12636  *------------------------------------------------------------*;
12637  * mergeVarMeansandClusLabel;
12638  *------------------------------------------------------------*;
12639  data temp(keep=_SEGMENT_ &CLUS_PROFVARS);
12640  length _SEGMENT_ &CLUS_PROFVARS 8;
12641  set EMWS2.Clus_OUTSTAT;
12642  where _type_ ='CLUS_MEAN';
12643  run;
 
NOTE: There were 3 observations read from the data set EMWS2.CLUS_OUTSTAT.
      WHERE _type_='CLUS_MEAN';
NOTE: The data set WORK.TEMP has 3 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12644  proc sort data=temp;
12645  by _SEGMENT_;
12646  run;
 
NOTE: There were 3 observations read from the data set WORK.TEMP.
NOTE: The data set WORK.TEMP has 3 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
 
 
12647  data EMWS2.Clus_LABEL;
12648  merge EMWS2.Clus_LABEL(keep=_SEGMENT_ LABEL) temp;
12649  by _SEGMENT_;
12650  run;
 
NOTE: There were 3 observations read from the data set EMWS2.CLUS_LABEL.
NOTE: There were 3 observations read from the data set WORK.TEMP.
NOTE: The data set EMWS2.CLUS_LABEL has 3 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
